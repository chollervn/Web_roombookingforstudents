<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
	th:replace="~{admin/admin_base::adminLayout(~{::section})}">
<head>
<meta charset="UTF-8">
<title>Chỉnh sửa phòng trọ</title>
</head>
<body>
	<section th:with="currentPage='rooms'">
		<style>
			.page-header {
				margin-bottom: 30px;
			}
			.page-header h2 {
				font-size: 28px;
				color: #2c3e50;
				margin-bottom: 10px;
			}
			.form-card {
				background: white;
				padding: 30px;
				border-radius: 12px;
				box-shadow: 0 2px 8px rgba(0,0,0,0.08);
			}
		</style>

		<div class="page-header">
			<h2><i class="fas fa-edit"></i> Chỉnh sửa phòng trọ</h2>
		</div>

		<th:block th:if="${session.succMsg}">
			<div class="alert alert-success alert-dismissible fade show">
				[[${session.succMsg}]]
				<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			</div>
			<th:block th:text="${@commonServiceImpl.removeSessionMessage()}"></th:block>
		</th:block>

		<th:block th:if="${session.errorMsg}">
			<div class="alert alert-danger alert-dismissible fade show">
				[[${session.errorMsg}]]
				<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			</div>
			<th:block th:text="${@commonServiceImpl.removeSessionMessage()}"></th:block>
		</th:block>

		<div class="form-card">
			<form action="/admin/updateRoom" method="post" enctype="multipart/form-data">
				<input type="hidden" name="id" th:value="${room.id}">

				<div class="row">
					<!-- Thông tin cơ bản -->
					<div class="col-md-6">
						<div class="mb-3">
							<label class="form-label"><i class="fas fa-home"></i> Tên phòng trọ *</label>
							<input type="text" name="roomName" th:value="${room.roomName}"
								   class="form-control" required>
						</div>

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-list"></i> Loại phòng *</label>
							<input type="text" name="roomType" th:value="${room.roomType}"
								   class="form-control" required>
						</div>

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-money-bill-wave"></i> Giá thuê/tháng (VNĐ) *</label>
							<input type="number" name="monthlyRent" th:value="${room.monthlyRent}"
								   class="form-control" min="0" required>
						</div>

						<div class="row">
							<div class="col-6">
								<div class="mb-3">
									<label class="form-label"><i class="fas fa-expand-arrows-alt"></i> Diện tích (m²) *</label>
									<input type="number" name="area" th:value="${room.area}"
										   class="form-control" step="0.1" min="0" required>
								</div>
							</div>
							<div class="col-6">
								<div class="mb-3">
									<label class="form-label"><i class="fas fa-users"></i> Số người tối đa *</label>
									<input type="number" name="maxOccupants" th:value="${room.maxOccupants}"
										   class="form-control" min="1" required>
								</div>
							</div>
						</div>
					</div>

					<!-- Địa chỉ và tiện ích -->
					<div class="col-md-6">
						<div class="mb-3">
							<label class="form-label"><i class="fas fa-map-marker-alt"></i> Địa chỉ *</label>
							<input type="text" name="address" th:value="${room.address}"
								   class="form-control" required>
						</div>

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-city"></i> Thành phố *</label>
							<select name="city" class="form-select" required>
								<option value="">-- Chọn thành phố --</option>
								<option value="Hà Nội" th:selected="${room.city == 'Hà Nội'}">Hà Nội</option>
								<option value="Hải Phòng" th:selected="${room.city == 'Hải Phòng'}">Hải Phòng</option>
								<option value="Thái Nguyên" th:selected="${room.city == 'Thái Nguyên'}">Thái Nguyên</option>
								<option value="Bắc Ninh" th:selected="${room.city == 'Bắc Ninh'}">Bắc Ninh</option>
								<option value="Vĩnh Phúc" th:selected="${room.city == 'Vĩnh Phúc'}">Vĩnh Phúc</option>
								<option value="Hưng Yên" th:selected="${room.city == 'Hưng Yên'}">Hưng Yên</option>
							</select>
						</div>

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-image"></i> Ảnh phòng trọ</label>
							<input type="file" name="file" class="form-control" accept="image/*">
							<small class="text-muted">Để trống nếu không muốn thay đổi ảnh</small>
							<div class="mt-2" th:if="${room.image}">
								<img th:src="@{'/img/room_img/'+${room.image}}"
									 style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px;">
							</div>
						</div>

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-info-circle"></i> Mô tả</label>
							<textarea name="description" class="form-control" rows="3" th:text="${room.description}"></textarea>
						</div>
					</div>

					<!-- Trạng thái -->
					<div class="col-md-12">
						<hr>
						<h5 class="mb-3"><i class="fas fa-cog"></i> Trạng thái phòng</h5>
						<div class="row">
							<div class="col-md-6">
								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" name="isActive"
										   th:checked="${room.isActive}" id="isActive">
									<label class="form-check-label" for="isActive">
										<i class="fas fa-eye"></i> Hiển thị phòng trên trang web
									</label>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" name="isAvailable"
										   th:checked="${room.isAvailable}" id="isAvailable">
									<label class="form-check-label" for="isAvailable">
										<i class="fas fa-check-circle"></i> Phòng còn trống
									</label>
								</div>
							</div>
						</div>
					</div>

					<!-- Buttons -->
					<div class="col-md-12 mt-4">
						<hr>
						<div class="d-flex justify-content-between">
							<a href="/admin/rooms" class="btn btn-secondary">
								<i class="fas fa-arrow-left"></i> Quay lại
							</a>
							<button type="submit" class="btn btn-primary">
								<i class="fas fa-save"></i> Cập nhật phòng trọ
							</button>
						</div>
					</div>
				</div>
			</form>
		</div>
	</section>
</body>
</html>