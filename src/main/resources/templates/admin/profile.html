<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
	th:replace="~{admin/admin_base::adminLayout(~{::section})}">
<head>
<meta charset="UTF-8">
<title>Hồ sơ admin</title>
</head>
<body>
	<section th:with="currentPage='profile'">
		<style>
			.page-header {
				margin-bottom: 30px;
			}
			.page-header h2 {
				font-size: 28px;
				color: #2c3e50;
				margin-bottom: 10px;
			}
			.profile-card {
				background: white;
				padding: 30px;
				border-radius: 12px;
				box-shadow: 0 2px 8px rgba(0,0,0,0.08);
			}
			.profile-image {
				width: 110px;
				height: 110px;
				border-radius: 50%;
				object-fit: cover;
				border: 4px solid #e3f2fd;
			}
		</style>

		<div class="page-header">
			<h2><i class="fas fa-user-circle"></i> Hồ sơ cá nhân</h2>
		</div>

		<th:block th:if="${session.succMsg}">
			<div class="alert alert-success alert-dismissible fade show">
				[[${session.succMsg}]]
				<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			</div>
			<th:block th:text="${@commonServiceImpl.removeSessionMessage()}"></th:block>
		</th:block>

		<th:block th:if="${session.errorMsg}">
			<div class="alert alert-danger alert-dismissible fade show">
				[[${session.errorMsg}]]
				<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			</div>
			<th:block th:text="${@commonServiceImpl.removeSessionMessage()}"></th:block>
		</th:block>

		<div class="profile-card">
			<div class="text-center mb-4">
				<img alt="Profile Image" th:src="@{'/uploads/profile_img/'+${user.profileImage}}"
					class="profile-image"
					onerror="this.src='/uploads/profile_img/default.jpg'">
			</div>

			<div class="row">
				<div class="col-md-8 offset-md-2">
					<form action="/admin/update-profile" method="post" enctype="multipart/form-data">
						<input type="hidden" name="id" th:value="${user.id}">

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-user"></i> Họ tên</label>
							<input type="text" name="name" class="form-control" th:value="${user.name}" required>
						</div>

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-phone"></i> Số điện thoại</label>
							<input type="text" name="mobileNumber" class="form-control" th:value="${user.mobileNumber}" required>
						</div>

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-envelope"></i> Email</label>
							<input type="email" class="form-control" th:value="${user.email}" readonly>
						</div>

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-map-marker-alt"></i> Địa chỉ</label>
							<input type="text" name="address" class="form-control" th:value="${user.address}">
						</div>

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-university"></i> Ngân hàng thụ hưởng</label>
							<select class="form-select form-control" name="bankId">
								<option value="">-- Chọn ngân hàng --</option>
								<option value="MB" th:selected="${user.bankId != null && user.bankId == 'MB'}">MB Bank</option>
								<option value="VCB" th:selected="${user.bankId != null && user.bankId == 'VCB'}">Vietcombank</option>
								<option value="TCB" th:selected="${user.bankId != null && user.bankId == 'TCB'}">Techcombank</option>
								<option value="ICB" th:selected="${user.bankId != null && user.bankId == 'ICB'}">VietinBank</option>
								<option value="BIDV" th:selected="${user.bankId != null && user.bankId == 'BIDV'}">BIDV</option>
								<option value="TPB" th:selected="${user.bankId != null && user.bankId == 'TPB'}">TPBank</option>
								<option value="ACB" th:selected="${user.bankId != null && user.bankId == 'ACB'}">ACB</option>
								<option value="VPB" th:selected="${user.bankId != null && user.bankId == 'VPB'}">VPBank</option>
								<option value="SHB" th:selected="${user.bankId != null && user.bankId == 'SHB'}">SHB</option>
								<option value="MSB" th:selected="${user.bankId != null && user.bankId == 'MSB'}">MSB</option>
							</select>
						</div>

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-credit-card"></i> Số tài khoản</label>
							<input type="text" name="accountNo" class="form-control"
								th:value="${user.accountNo != null ? user.accountNo : ''}"
								placeholder="Nhập số tài khoản ngân hàng (tùy chọn)">
							<small class="form-text text-muted">Nhập số tài khoản ngân hàng (9-16 chữ số)</small>
						</div>

						<div class="mb-3">
							<label class="form-label"><i class="fas fa-image"></i> Ảnh đại diện</label>
							<input type="file" name="img" class="form-control" accept="image/*">
						</div>

						<div class="d-grid gap-2">
							<button type="submit" class="btn btn-primary">
								<i class="fas fa-save"></i> Cập nhật hồ sơ
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<!-- Đổi mật khẩu -->
		<div class="profile-card mt-4">
			<h4 class="mb-4"><i class="fas fa-lock"></i> Đổi mật khẩu</h4>
			<div class="row">
				<div class="col-md-8 offset-md-2">
					<form action="/admin/change-password" method="post">
						<div class="mb-3">
							<label class="form-label">Mật khẩu hiện tại</label>
							<input type="password" name="currentPassword" class="form-control" required>
						</div>

						<div class="mb-3">
							<label class="form-label">Mật khẩu mới</label>
							<input type="password" name="newPassword" class="form-control" required>
						</div>

						<div class="d-grid gap-2">
							<button type="submit" class="btn btn-warning">
								<i class="fas fa-key"></i> Đổi mật khẩu
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>

	</section>
</body>
</html>
