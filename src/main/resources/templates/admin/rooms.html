<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
	th:replace="~{admin/admin_base::adminLayout(~{::section})}">
<head>
<meta charset="UTF-8">
<title>Danh sách phòng trọ</title>
</head>
<body>
	<section th:with="currentPage='rooms'">
		<style>
			.page-header {
				margin-bottom: 30px;
			}
			.page-header h2 {
				font-size: 28px;
				color: #2c3e50;
				margin-bottom: 10px;
			}
			.search-box {
				background: white;
				padding: 20px;
				border-radius: 12px;
				box-shadow: 0 2px 8px rgba(0,0,0,0.08);
				margin-bottom: 20px;
			}
			.table-container {
				background: white;
				padding: 25px;
				border-radius: 12px;
				box-shadow: 0 2px 8px rgba(0,0,0,0.08);
			}
		</style>

		<div class="page-header">
			<h2><i class="fas fa-door-open"></i> Danh sách phòng trọ</h2>
		</div>

		<th:block th:if="${session.succMsg}">
			<div class="alert alert-success alert-dismissible fade show">
				[[${session.succMsg}]]
				<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			</div>
			<th:block th:text="${@commonServiceImpl.removeSessionMessage()}"></th:block>
		</th:block>

		<th:block th:if="${session.errorMsg}">
			<div class="alert alert-danger alert-dismissible fade show">
				[[${session.errorMsg}]]
				<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			</div>
			<th:block th:text="${@commonServiceImpl.removeSessionMessage()}"></th:block>
		</th:block>

		<div class="search-box">
			<form action="/admin/rooms" method="get">
				<div class="row">
					<div class="col-md-10">
						<input type="text" class="form-control" name="ch" placeholder="Tìm kiếm phòng trọ theo tên hoặc loại phòng...">
					</div>
					<div class="col-md-2">
						<button class="btn btn-primary w-100"><i class="fas fa-search"></i> Tìm kiếm</button>
					</div>
				</div>
			</form>
		</div>

		<div class="table-container">
			<table class="table table-hover table-bordered">
				<thead class="table-light">
					<tr>
						<th scope="col">STT</th>
						<th scope="col">Ảnh</th>
						<th scope="col">Tên phòng</th>
						<th scope="col">Loại phòng</th>
						<th scope="col">Giá thuê/tháng</th>
						<th scope="col">Diện tích (m²)</th>
						<th scope="col">Địa chỉ</th>
						<th scope="col">Trạng thái</th>
						<th scope="col">Tình trạng</th>
						<th scope="col">Hành động</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="room,c:${rooms}">
						<th scope="row">[[${c.count}]]</th>
						<td><img th:src="@{'/uploads/room_img/'+${room.image}}"
							width="70px" height="70px" style="object-fit: cover; border-radius: 8px;"></td>
						<td>[[${room.roomName}]]</td>
						<td>[[${room.roomType}]]</td>
						<td>[[${#numbers.formatDecimal(room.monthlyRent, 0, 'COMMA', 0, 'POINT')}]] VNĐ</td>
						<td>[[${room.area}]]</td>
						<td>[[${room.address}]], [[${room.city}]]</td>
						<td>
							<span th:if="${room.isActive}" class="badge bg-success">Hiển thị</span>
							<span th:unless="${room.isActive}" class="badge bg-secondary">Ẩn</span>
						</td>
						<td>
							<span th:if="${room.isAvailable}" class="badge bg-primary">Còn trống</span>
							<span th:unless="${room.isAvailable}" class="badge bg-warning">Đã cho thuê</span>
						</td>
						<td>
							<a th:href="@{'/admin/editRoom/'+${room.id}}"
								class="btn btn-sm btn-primary"><i
								class="fa-solid fa-pen-to-square"></i> Sửa</a>
							<a th:href="@{'/admin/deleteRoom/'+${room.id}}"
								class="btn btn-sm btn-danger"
								onclick="return confirm('Bạn có chắc muốn xóa phòng này?')"><i
								class="fa-solid fa-trash"></i> Xóa</a>
						</td>
					</tr>
					<tr th:if="${#lists.isEmpty(rooms)}">
						<td colspan="10" class="text-center text-muted py-5">
							<i class="fas fa-inbox fa-3x mb-3" style="opacity: 0.3;"></i>
							<p>Chưa có phòng trọ nào</p>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</section>
</body>
</html>