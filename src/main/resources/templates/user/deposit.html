<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" th:replace="~{base::layout(~{::section})}">
<head>
<meta charset="UTF-8">
<title>Đặt cọc phòng trọ</title>
</head>
<body>
<section style="padding-top: 90px; min-height: 70vh;">
	<div class="container mt-3 p-3">
		<div class="card card-sh">
			<div class="card-header text-center bg-primary text-white">
				<h4><i class="fas fa-money-check-alt"></i> Đặt cọc phòng trọ</h4>
			</div>

			<th:block th:if="${session.succMsg}">
				<p class="text-success fw-bold alert alert-success m-3">[[${session.succMsg}]]</p>
				<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
			</th:block>

			<th:block th:if="${session.errorMsg}">
				<p class="text-danger fw-bold alert alert-danger m-3">[[${session.errorMsg}]]</p>
				<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
			</th:block>

			<div class="card-body">
				<div class="row">
					<!-- Thông tin phòng trọ -->
					<div class="col-md-5">
						<h5 class="text-primary mb-3"><i class="fas fa-home"></i> Thông tin phòng</h5>
						<img th:src="@{'/img/room_img/'+${room.image}}" alt="Ảnh phòng"
							class="img-fluid img-thumbnail mb-3" style="max-height:250px; width:100%; object-fit:cover;"/>

						<div class="card mb-3">
							<div class="card-body">
								<h6 class="card-title text-success" th:text="${room.roomName}">Tên phòng</h6>
								<p class="mb-1"><i class="fas fa-tag text-warning"></i> <strong>Loại:</strong> <span th:text="${room.roomType}">Loại phòng</span></p>
								<p class="mb-1"><i class="fas fa-map-marker-alt text-danger"></i> <strong>Địa chỉ:</strong> <span th:text="${room.fullAddress}">Địa chỉ</span></p>
								<p class="mb-1"><i class="fas fa-money-bill-wave text-success"></i> <strong>Giá thuê:</strong>
									<span th:text="${#numbers.formatDecimal(room.monthlyRent, 0, 'COMMA', 0, 'POINT')}">0</span> VNĐ/tháng
								</p>
								<hr>
								<p class="mb-1"><i class="fas fa-user text-info"></i> <strong>Chủ trọ:</strong> <span th:text="${room.contactName}">Chủ trọ</span></p>
								<p class="mb-0"><i class="fas fa-phone text-primary"></i> <strong>Liên hệ:</strong> <span th:text="${room.contactPhone}">0900...</span></p>
							</div>
						</div>
					</div>

					<!-- Form đặt cọc -->
					<div class="col-md-7">
						<h5 class="text-primary mb-3"><i class="fas fa-file-invoice-dollar"></i> Thông tin đặt cọc</h5>
						<form th:action="@{/user/save-deposit}" method="post">
							<input type="hidden" name="rid" th:value="${room.id}"/>

							<div class="mb-3">
								<label class="form-label"><i class="fas fa-money-bill"></i> Số tiền đặt cọc (VNĐ) *</label>
								<input type="number" step="0.01" min="0" name="amount" class="form-control form-control-lg"
									th:value="${suggestedDeposit}" readonly required />

							</div>

							<div class="mb-3">
								<label class="form-label"><i class="fas fa-credit-card"></i> Phương thức thanh toán *</label>
								<select name="paymentMethod" class="form-select" required>
									<option value="CASH">Tiền mặt</option>
									<option value="BANK_TRANSFER">Chuyển khoản ngân hàng</option>
									<option value="E_WALLET">Ví điện tử (Momo, ZaloPay...)</option>
								</select>
							</div>

							<div class="mb-3">
								<label class="form-label"><i class="fas fa-comment"></i> Ghi chú (không bắt buộc)</label>
								<textarea rows="3" class="form-control" name="note"
									placeholder="Thời gian mong muốn nhận phòng, yêu cầu đặc biệt..."></textarea>
							</div>

							<div class="alert alert-info">
								<i class="fas fa-info-circle"></i> <strong>Lưu ý quan trọng:</strong>
								<ul class="mb-0 mt-2">
									<li>Sau khi đặt cọc, chủ trọ sẽ xem xét và xác nhận đơn của bạn</li>
									<li>Vui lòng liên hệ trực tiếp với chủ trọ để xác nhận thông tin và thời gian nhận phòng</li>
									<li>Tiền cọc sẽ được trừ vào tiền thuê tháng đầu tiên</li>
								</ul>
							</div>

							<div class="d-grid gap-2">
								<button type="submit" class="btn btn-success btn-lg">
									<i class="fas fa-check-circle"></i> Xác nhận đặt cọc
								</button>
								<a href="/user/cart" class="btn btn-secondary">
									<i class="fas fa-arrow-left"></i> Quay lại Trọ đã xem
								</a>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>
</body>
</html>
